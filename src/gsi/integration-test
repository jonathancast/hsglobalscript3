#! /usr/local/plan9/bin/rc -e

./build-tests

./Test

. $GLOBALSCRIPT/bin/test-fns

GLOBALSCRIPT=$HSGLOBALSCRIPT

echo '## test-gsi'

ok_grep_errors '-- non-existent source file --' 'no-such-file.gs: Could not load' ./test-gsi no-such-file.gs
TODO='variables don''t work yet' ok_grep_errors '-- variable not in scope --' 'foo not in scope' ./test-gsi unbound-variable.gs

echo '## gsi'

ok_grep_errors '-- non-existent source file --' 'no-such-file.gs: Could not load' ./gsi no-such-file.gs
ok_grep_errors '-- empty source file --' 'empty-file.gs:1:1: undefined' ./gsi empty-file.gs
ok_grep_errors '-- #! lines --' 'empty-shebang-line.gs:2:1: undefined' ./gsi empty-shebang-line.gs
