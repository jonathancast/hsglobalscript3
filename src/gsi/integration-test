#! /usr/local/plan9/bin/rc -e

./build

ghc `{./ghcoptions} --make Test.hs
./Test

. $GLOBALSCRIPT/bin/test-fns

ghc `{./ghcoptions} --make test-gsi.hs

GLOBALSCRIPT=$HSGLOBALSCRIPT

echo '## test-gsi'

ok_grep_errors '-- non-existent source file --' 'no-such-file.gs: Could not load' ./test-gsi no-such-file.gs

echo '## gsi'

ok_grep_errors '-- non-existent source file --' 'no-such-file.gs: Could not load' ./gsi no-such-file.gs
ok_grep_errors '-- empty source file --' 'empty-file.gs:1:1: undefined' ./gsi empty-file.gs
